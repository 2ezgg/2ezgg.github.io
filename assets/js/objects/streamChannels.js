function StreamChannels(){this.streamers=JSON.parse(localStorage.getItem("streamers"));var a=[];this.streamers||(localStorage.setItem("streamers",JSON.stringify(a)),this.streamers=JSON.parse(localStorage.getItem("streamers"))),this.twitchStreamersOnline=[],this.topTwitchStreamersOnline=[],this.twitchStreamersOffline=[],this.azubuStreamersOffline=[],this.azubuStreamersOnline=[],this.topAzubuStreamersOnline=[],this.totalStreamersOnline=0,this.streamerCount=0,this.newAdditions=[],this.recentlyAddedAzub=[],this.recentlyAddedTwitch=[],this.currentStreamDisplayed=null,this.currentStreamViewers=null,this.streamFunctionCount=0,this.noStreamersAdded=0==this.streamers.length?!0:!1}StreamChannels.prototype.submitStreamer=function(a,b){var c,d="";if(a){if("azubu"==b)d=a,c="azubu";else if(a.match(/azubu.tv/i)){c="azubu";var e=/\d{13}/gi;d=e.exec(a).toString()}else{var a=a.trim();c="twitch",d=a.replace(/((.*?:\/\/)|www.twitch.tv\/)|(\s)/gi,"").toLowerCase()}if(d){for(var f=!0,g=0;g<this.streamers.length;g++)this.streamers[g].name==d&&(f=!1);return f&&(this.streamers[this.streamers.length]={name:d,service:c},"twitch"==c?this.recentlyAddedTwitch.push(d):this.recentlyAddedAzub.push(d)),localStorage.setItem("streamers",JSON.stringify(this.streamers)),this.noStreamersAdded=0==this.streamers.length?!0:!1,!0}}return!1},StreamChannels.prototype.onlineTwitchStreamers=function(){var a=$.Deferred(),b=this,c="";if(this.noStreamersAdded)return localStorage.setItem("twitchStreamersOnline","[]"),localStorage.setItem("twitchStreamersOffline","[]"),a.resolve(),a.promise();for(var d=0;d<this.streamers.length;d++)"twitch"==this.streamers[d].service&&(c+=this.streamers[d].name+",");return $.ajax({dataType:"jsonp",url:"https://api.twitch.tv/kraken/streams?channel="+c,error:function(){console.log("Unable to twitch favourites api")},success:function(c){if(b.twitchStreamersOnline=[],c.streams)for(var d=0;d<c.streams.length;d++)b.twitchStreamersOnline[d]={name:c.streams[d].channel.name,displayName:c.streams[d].channel.display_name,viewTotal:c.streams[d].viewers,url:c.streams[d].channel.url,thumbnailUrl:c.streams[d].preview.medium,id:d},b.totalStreamersOnline++;localStorage.setItem("totalStreamersOnline",JSON.stringify(b.totalStreamersOnline)),localStorage.setItem("twitchStreamersOnline",JSON.stringify(b.twitchStreamersOnline)),a.resolve()}}),a.promise()},StreamChannels.prototype.getAzubuStreamers=function(){var a=$.Deferred(),b=this;return $.ajax({dataType:"jsonp",url:"http://liveleaguestream.com/json.php?method=getAll&jsoncallback=?",error:function(){console.log("Unable to load azubu api")},success:function(c){var d=0,e=0,f=0;b.topAzubuStreamersOnline=[],b.azubuStreamersOnline=[],b.azubuStreamersOffline=[];for(var g=0;g<c.length;g++)if("0"!=c[g].Online){for(var h=!1,i=0;i<b.streamers.length;i++)c[g].Azubu_ID==b.streamers[i].name&&(h=!0);b.topAzubuStreamersOnline[f]={name:c[g].Name,id:c[g].Azubu_ID,count:f,online:!0,isAlreadyAdded:h},f++;for(var j=0;j<b.streamers.length;j++)b.streamers[j].name==c[g].Azubu_ID&&(b.azubuStreamersOnline[d]={name:c[g].Name,id:c[g].Azubu_ID,online:!0},d++,b.totalStreamersOnline++)}else for(var k=0;k<b.streamers.length;k++)b.streamers[k].name==c[g].Azubu_ID&&(b.azubuStreamersOffline[e]={name:c[g].Name,id:c[g].Azubu_ID,online:!1},e++);localStorage.setItem("totalStreamersOnline",JSON.stringify(b.totalStreamersOnline)),localStorage.setItem("topAzubuStreamersOnline",JSON.stringify(b.topAzubuStreamersOnline)),localStorage.setItem("azubuStreamersOnline",JSON.stringify(b.azubuStreamersOnline)),localStorage.setItem("azubuStreamersOffline",JSON.stringify(b.azubuStreamersOffline)),a.resolve()}}),a.promise()},StreamChannels.prototype.topTwitchOnline=function(a){var b=a||12,c=$.Deferred(),d=this;return $.ajax({dataType:"jsonp",url:"https://api.twitch.tv/kraken/search/streams?q=%22league%20of%20legends%22&limit="+b,error:function(){console.log("Unable to load top twitch streamers feed.")},success:function(a){if(d.topTwitchStreamersOnline=[],a.streams)for(var b=0;b<a.streams.length;b++){for(var e=!1,f=0;f<d.twitchStreamersOnline.length;f++)a.streams[b].channel.name==d.twitchStreamersOnline[f].name&&(e=!0);d.topTwitchStreamersOnline[b]={name:a.streams[b].channel.name,displayName:a.streams[b].channel.display_name,viewTotal:a.streams[b].viewers,thumbnailUrl:a.streams[b].preview.medium,url:a.streams[b].channel.url,isAlreadyAdded:e,id:b}}localStorage.setItem("topTwitchStreamersOnline",JSON.stringify(d.topTwitchStreamersOnline)),c.resolve()}}),c.promise()},StreamChannels.prototype.offlineTwitchStreamers=function(){this.twitchStreamersOffline=[],this.twitchStreamersOffline=this.streamers.slice(0);for(var a=[],b=0;b<this.streamers.length;b++)"twitch"!=this.twitchStreamersOffline[b].service&&a.push(b);a.reverse();for(var c=0;c<a.length;c++)this.twitchStreamersOffline.splice(a[c],1);for(var d=0;d<this.twitchStreamersOnline.length;d++){for(var e,f=0;f<this.twitchStreamersOffline.length;f++)this.twitchStreamersOffline[f].name==this.twitchStreamersOnline[d].name&&(e=f);e>-1&&this.twitchStreamersOffline.splice(e,1)}localStorage.setItem("twitchStreamersOffline",JSON.stringify(this.twitchStreamersOffline))},StreamChannels.prototype.removeStreamer=function(a){var b=a.toString().toLowerCase();if(b){for(var c=0;c<this.streamers.length;c++)this.streamers[c].name==b&&this.streamers.splice(c,1);return localStorage.setItem("streamers",JSON.stringify(this.streamers)),this.noStreamersAdded=0==this.streamers.length?!0:!1,!0}return!1},StreamChannels.prototype.pushTwitchStreams=function(a,b){var c=this,d=Handlebars.compile($("#twitch-template").html()),a=a||0;"top"==b?($("#twitch-online-content").html(d(c.topTwitchStreamersOnline[a])),c.currentStreamDisplayed=c.topTwitchStreamersOnline[a].name,c.currentStreamViewers=c.topTwitchStreamersOnline[a].viewTotal):c.twitchStreamersOnline.length>0&&($("#twitch-online-content").html(d(c.twitchStreamersOnline[a])),c.currentStreamDisplayed=c.twitchStreamersOnline[a].name,c.currentStreamViewers=c.twitchStreamersOnline[a].viewTotal)},StreamChannels.prototype.pushStreamsHeader=function(){for(var a=this,b=0;b<a.topTwitchStreamersOnline.length;b++)if("riotgames"==a.topTwitchStreamersOnline[b].name&&"on"==appSettings.eSportsNotifications){var c=Handlebars.compile($("#riot-online-message-template").html());$("#riot-online").html(c()),$("#top-header-message").css("padding","14px")}},StreamChannels.prototype.pushTwitchStreamers=function(a){var b=this;if(null==a){var c=Handlebars.compile($("#twitch-users-online-template").html()),d=Handlebars.compile($("#twitch-users-offline-template").html());$("#twitch-list-online").html(c(b.twitchStreamersOnline)),$("#twitch-list-offline").html(d(b.twitchStreamersOffline))}else{var e=Handlebars.compile($("#twitch-user-favourited-online-template").html());$("#twitch-list-online").append(e(b.topTwitchStreamersOnline[a]))}},StreamChannels.prototype.pushAzubuStreamers=function(a){var b=this;if(null==a){var c=Handlebars.compile($("#azubu-users-online-template").html()),d=Handlebars.compile($("#azubu-users-offline-template").html()),e=Handlebars.compile($("#azubu-top-online-template").html());$("#azubu-top-streamers").html(e(b.topAzubuStreamersOnline)),$("#azubu-list-online").html(c(b.azubuStreamersOnline)),$("#azubu-list-offline").html(d(b.azubuStreamersOffline))}else{var f=Handlebars.compile($("#azubu-users-favourited-online-template").html());$("#azubu-list-online").append(f(b.topAzubuStreamersOnline[a]))}},StreamChannels.prototype.pushTopStreamerOnline=function(a,b,c){var d=this;if(c)for(var c=Handlebars.compile($("#twitch-template").html()),e=0;e<d.topTwitchStreamersOnline.length;e++)d.topTwitchStreamersOnline[e].name==a&&$("#twitch-online-content").prepend(c(d.topTwitchStreamersOnline[e]));if(b)for(var f=Handlebars.compile($("#twitch-add-user-online-template").html()),e=0;e<d.topTwitchStreamersOnline.length;e++)d.topTwitchStreamersOnline[e].name==a&&$("#twitch-list-online").append(f(d.topTwitchStreamersOnline[e]))},StreamChannels.prototype.pushTopTwitchStreamers=function(){var a=this,b=Handlebars.compile($("#twitch-top-online-template").html());$("#twitch-top-streamers").html(b(a.topTwitchStreamersOnline))},StreamChannels.prototype.currentStreamOnline=function(){for(var a=0;a<this.topTwitchStreamersOnline.length;a++)if(this.topTwitchStreamersOnline[a].name==this.currentStreamDisplayed)return!0;for(var b=0;b<this.twitchStreamersOnline.length;b++)if(this.twitchStreamersOnline[b].name==this.currentStreamDisplayed)return!0;return!1},StreamChannels.prototype.pushTopTwitchStreamers=function(){var a=this,b=Handlebars.compile($("#twitch-top-online-template").html());$("#twitch-top-streamers").html(b(a.topTwitchStreamersOnline))},StreamChannels.prototype.favouriteStreamerMessage=function(a,b){var c=0;this.newAdditions=[];for(var d=0;d<this.azubuStreamersOnline.length;d++){for(var e=!1,f=0;f<a.length;f++)a[f].name==this.azubuStreamersOnline[d].name&&(e=!0);if(!e){for(var g=!1,h=0;h<this.recentlyAddedAzub.length;h++)this.recentlyAddedAzub[h]==this.azubuStreamersOnline[d].name&&(g=!0);g||(this.newAdditions[c]={name:this.azubuStreamersOnline[d].name,id:this.azubuStreamersOnline[d].id,azubu:!0},c++)}}for(var i=0;i<this.twitchStreamersOnline.length;i++){for(var j=!1,k=0;k<b.length;k++)b[k].name==this.twitchStreamersOnline[i].name&&(j=!0);if(!j){for(var l=!1,h=0;h<this.recentlyAddedTwitch.length;h++)this.recentlyAddedTwitch[h]==this.twitchStreamersOnline[i].name&&(l=!0);l||(this.newAdditions[c]={name:this.twitchStreamersOnline[i].name,id:null,twitch:!0},c++)}}if(c>0&&("on"==appSettings.twitchAudioNotifications&&$("#sound").html('<audio controls autoplay style="display:none"><source src="assets/sound/notify.mp3" hidden="true" autostart="true" loop="false" type="audio/mpeg"></audio>'),"on"==appSettings.twitchVisualNotifications)){var m=Handlebars.compile($("#streamer-online-message-template").html());$("#favourite-online").html(m(this.newAdditions)),$("#top-header-message").css("padding","14px")}};